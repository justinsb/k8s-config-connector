---
apiVersion: composer.cnrm.cloud.google.com/v1alpha1
kind: ComposerEnvironment
metadata:
  labels:
    cnrm-test: "true"
    managed-by-cnrm: "true"
  name: minimal${uniqueId}
spec:
  config:
    airflowUri: https://8a15ac1b3bb344aeb75f689704d62542-dot-us-central1.composer.googleusercontent.com
    dagGcsPrefix: gs://us-central1-minimalysar6b7a-562a92f7-bucket/dags
    environmentSize: ENVIRONMENT_SIZE_SMALL
    gkeCluster: projects/example-project-id/locations/us-central1/clusters/us-central1-minimalysar6b7a-562a92f7-gke
    maintenanceWindow:
      endTime: "1970-01-01T04:00:00Z"
      recurrence: FREQ=WEEKLY;BYDAY=FR,SA,SU
      startTime: "1970-01-01T00:00:00Z"
    nodeConfig:
      network: projects/example-project-id/global/networks/default
      serviceAccountRef:
        external: composer-${uniqueId}@example-project-id.iam.gserviceaccount.com
    privateEnvironmentConfig:
      cloudComposerNetworkIpv4CidrBlock: 172.31.245.0/24
      cloudSqlIpv4CidrBlock: 10.0.0.0/12
      enablePrivateEndpoint: false
    resilienceMode: STANDARD_RESILIENCE
    softwareConfig:
      cloudDataLineageIntegration:
        enabled: false
      imageVersion: composer-2.4.6-airflow-2.5.3
    webServerNetworkAccessControl:
      allowedIpRange:
      - description: Allows access from all IPv4 addresses (default value)
        value: 0.0.0.0/0
      - description: Allows access from all IPv6 addresses (default value)
        value: ::0/0
    workloadsConfig:
      scheduler:
        count: 1
        cpu: 0.5
        memoryGb: 2
        storageGb: 1
      webServer:
        cpu: 0.5
        memoryGb: 2
        storageGb: 1
      worker:
        cpu: 0.5
        maxCount: 3
        memoryGb: 2
        minCount: 1
        storageGb: 1
  projectRef:
    external: example-project-id
  region: us-central1
  resourceID: minimal${uniqueId}
...